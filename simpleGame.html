<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>JS Matrices</title>
        
    </head>
    <body>
    
    </body>
	<script type="text/javascript">
        //<![CDATA[
            function Matrix() {
                this.rows = new Array();
                this.tableAsString = function() {
                    var temp = "";
                    for ( var i = 0; i < this.rows.length; ++i ) {
                        temp += this.rows[i];
                        if ( i < this.rows.length - 1 ) {
                            temp += "\n";
                        }
					
                    }					
                    return temp;
                };
                this.width = function() {
                    return this.rows[0].length;
                };
                this.height = function() {
                    return this.rows.length;
                };
                this.asTableElement = function(w,h,t,p,s,b,a) {
                    var table = document.createElement("table");					
                    table.style.width = w;
                    table.style.height = h;
                    table.style.textAlign = a;
                    var caption = document.createElement("caption");
                    caption.appendChild( document.createTextNode(t) );
                    table.appendChild( caption );
                    table.setAttribute("cellspacing", s );
                    table.setAttribute("cellpadding", p);
                    table.setAttribute("border", b );
					table.setAttribute("id", "tableId");					
                    for ( var i = 0; i < this.rows.length; ++i ) {
                        var tr = document.createElement("tr");
						tr.setAttribute("id", "link");
                        for ( var z = 0; z < this.rows[i].length; ++z ) {
                            var td = document.createElement("td");
                            td.appendChild( document.createTextNode( this.rows[i][z] ) );
                            tr.appendChild( td );
                        }
                        table.appendChild( tr );
                    }
                    return table;
                };
            }
			function addCellHandlers(tId, fClickHandler) {			
				var table = document.getElementById(tId);
				var rows = table.getElementsByTagName("tr");
				for (i = 0; i < rows.length; i++) {
					var currentRow = table.rows[i].getElementsByTagName("td");					
					for (j = 0; j < currentRow.length; j++)
					{
						currentRow[j].onclick = (function () {													
													 crossOrNot(this);													 
													 checkGame(table);
													});						
					}
				}
			}
			function crossOrNot(cell) {		
				cell.innerHTML = cell.innerHTML === "X" ? 0 : "X";				
			}
			
			function checkGame(table) {			
					var rows = table.getElementsByTagName("tr");
					var cLength = rows.length;
					var x = 2; //Number of X's that have to be adjacent (2 means 3 X's)
					for (j = 0; j < cLength - x; j++)
					{					
						for (i = 0; i < rows.length - x; i++) {						
							var currentRow = table.rows[j].getElementsByTagName("td");
							
							if(currentRow[i].innerHTML && currentRow[i+1].innerHTML && currentRow[i+2].innerHTML === "X")
							{
								alert("endgame");
							}
						}
					}
				}
            window.onload = function() {
                var m = new Matrix();
				for(var i=0; i<5;i++)
				{
					m.rows[i] = new Array(0, 0, 0, 0, 0);
				}								
                document.body.appendChild( m.asTableElement( "300px", "300px", "simpleGame", 5, 5, 5, "center" ) );
				addCellHandlers("tableId");
				
				//document.body.setChild( m.asTableElement( "300px", "300px", "simpleGame", 5, 5, 5, "center" ) );
                // make IE update display
                if ( navigator.userAgent.toLowerCase().indexOf("msie") != -1 && !window.opera ) {
                    document.body.innerHTML = document.body.innerHTML;
                }
            };
        </script>
</html>